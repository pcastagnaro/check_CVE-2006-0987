import subprocess
import sys
from termcolor import colored

def check_vulnerability(domain):
    try:
        # Run the dig command
        result = subprocess.run(
            ['dig', 'google.com', f'@{domain}'],
            capture_output=True,
            text=True
        )
        
        # Check for the specific string in the output
        if 'recursion requested but not available' in result.stdout:
            print(colored(f"{domain}: Not Vulnerable", 'green'))
        else:
            print(colored(f"{domain}: Vulnerable", 'red'))
    
    except Exception as e:
        print(colored(f"Error checking {domain}: {e}", 'yellow'))

def main():
    if len(sys.argv) != 2:
        print("Usage: python script.py <filename>")
        sys.exit(1)

    filename = sys.argv[1]

    try:
        with open(filename, 'r') as file:
            domains = file.readlines()
        
        for domain in domains:
            domain = domain.strip()
            if domain:
                check_vulnerability(domain)
    
    except FileNotFoundError:
        print(colored(f"File {filename} not found.", 'yellow'))
    except Exception as e:
        print(colored(f"An error occurred: {e}", 'yellow'))

if __name__ == "__main__":
    main()